<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta content="content-type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="author" content="Colin Duffy">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
    
    <title>Apollo Timeline - Tweening</title>
    
    <!-- Stylesheets -->
    <style type="text/css">
      #overlay {
        font-family: Helvetica, Arial, sans-serif;
        position: absolute;
        left: 10px;
        top:  10px;
      }
      #box {
        background-color: #F00;
        position: absolute;
      }
    </style>
    
    <!-- Scripts -->
    <script type="text/javascript" src="./DOMExtend.js"></script>
    <script type="text/javascript" src="../src/Bezier.js"></script>
    <script type="text/javascript" src="../src/Keyframe.js"></script>
    <script type="text/javascript" src="../src/Marker.js"></script>
    <script type="text/javascript" src="../src/Timeline.js"></script>
    <script type="text/javascript" src="../src/Timer.js"></script>
  </head>
  <body>
    <div id="overlay"></div>
    <div id="box"></div>
    
    <script type="text/javascript">
      var visibilityChange = "visibilitychange";
      var domHidden        = "hidden";
      
      if(typeof document.mozHidden !== "undefined") {
          domHidden        = "mozHidden";
          visibilityChange = "mozvisibilitychange";
      } else if(typeof document.msHidden !== "undefined") {
          domHidden        = "msHidden";
          visibilityChange = "msvisibilitychange";
      } else if(typeof document.webkitHidden !== "undefined") {
          domHidden        = "webkitHidden";
          visibilityChange = "webkitvisibilitychange";
      }
      
      function visibilityChangeHandler(evt) {
        var hidden = document[ domHidden ];
        hidden ? Timer.pauseAll() : Timer.playAll();
      }
      
      var timeline, box, overlay;
      
      function onUpdate() {
        var log = "<b>Timeline</b>";
        log += "<br>Seconds: " + timeline.seconds.toFixed(2);
        log += "<br>Duration: " + timeline.duration.toFixed(2);
        log += "<br>Speed: " + timeline.timer.time.toFixed(2);
        log += "<br>Mode: " + timeline.mode;
        log += "<br>Played: " + timeline.timesPlayed;
        log += "<br>Max Plays: " + timeline.maxPlays;
        overlay.innerHTML = log;
      }
      
      window.onload = function() {
        overlay = document.getElementById("overlay");
        
        box = document.getElementById("box");
        DOM.extend( box );
        box.x     = 100;
        box.y     = 200;
        box.width = box.height = 100;
        
        timeline = new Timeline();
        timeline.duration = 3;
        // timeline.playMode = PlayMode.ONCE;
        timeline.playMode = PlayMode.LOOP;
        // timeline.playMode = PlayMode.PING_PONG;
        timeline.onUpdate = onUpdate;
        timeline.setTime( 1 );
        
        timeline.add( box, 'x', 200, 1, 0.5, 0.75, 0, 0.5, 1 );
        timeline.add( box, 'y', 300, 1, 1.5, 0.75, 0, 0.5, 1 );
        timeline.restart();
        timeline.play();
        
        document.addEventListener( visibilityChange, visibilityChangeHandler, false );
      };
    </script>
  </body>
</html>
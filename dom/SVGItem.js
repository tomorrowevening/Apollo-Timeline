"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function styleOptions(e,t,a){var i={fill:"none",fillAlpha:1,stroke:void 0,strokeAlpha:1,strokeCap:"butt",strokeCorner:"miter",strokeDashes:void 0,strokeWidth:void 0,transform:void 0,timeline:[]},r=void 0,n=t.length;for(r=0;r<n;++r){var o=t[r];if("fill"===o.type){var l=Math.round(255*o.value.color[0]).toString(),s=Math.round(255*o.value.color[1]).toString(),c=Math.round(255*o.value.color[2]).toString(),h=o.value.opacity;i.fill="rgb("+l+", "+s+", "+c+")",i.fillAlpha=h,o.timeline.length>0&&(i.timeline=i.timeline.concat(o.timeline))}else if("stroke"===o.type){var m=Math.round(255*o.value.color[0]).toString(),f=Math.round(255*o.value.color[1]).toString(),p=Math.round(255*o.value.color[2]).toString();i.stroke="rgb("+m+", "+f+", "+p+")",i.strokeAlpha=o.value.opacity,i.strokeCap=o.value.cap,i.strokeCorner=o.value.corner,i.strokeDashes=o.value.dashes,i.strokeWidth=o.value.width,o.timeline.length>0&&(i.timeline=i.timeline.concat(o.timeline))}else if("transform"===o.type)i.transform=o;else if("trim"===o.type)for(var v=e.children.length,u=0;u<v;++u){var y=e.children[u];"path"===y.tagName&&applyTrimPath(y,o,a)}}return i}function applyTrimPath(e,t,a){e._startPercent=t.value.start,e._endPercent=t.value.end,e._offsetPercent=t.value.offset,e.updatePath();var i={start:"startPercent",end:"endPercent",offset:"offsetPercent"},r=void 0,n=t.timeline.length-1;for(r=n;r>-1;--r){var o=t.timeline[r],l=i[o.name];if(void 0!==l){var s=void 0,c=o.keys.length;for(s=0;s<c;++s){var h=o.keys[s],m=h.target,f=h.duration,p=h.x0,v=h.y0,u=h.x1,y=h.y1,d={ease:[p,v,u,y],start:h.value,delay:h.start},g=new Keyframe(e,l,m,f,d);g.easeType=h.type,a.addKeyframe(g)}}}}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),_CSSUtil=require("apollo-utils/CSSUtil"),_SVGUtil=require("apollo-utils/SVGUtil"),_SVGUtil2=require("./SVGUtil"),SVGItem=function(){function e(t,a){_classCallCheck(this,e),this.item=(0,_SVGUtil.SVGCreate)(),(0,_CSSUtil.CSSExtend)(this.item),this.item.title=t.name;var i=(0,_SVGUtil.createMasks)(this.item,t);void 0!==t.transform&&transform(this.item,t.transform,a);for(var r=t.content.length,n=0;n<r;++n){var o=t.content[n],l=void 0,s=void 0;if("shape"===o.type){var c=styleOptions(this.item,o.content,a),h=(0,_SVGUtil.getMaxBorder)(c);for(s=o.paths.length,l=0;l<s;++l){var m=o.paths[l],f=void 0;switch(m.type){case"rectangle":f=(0,_SVGUtil.SVGRectangle)(m,c,this.item,a);break;case"ellipse":f=(0,_SVGUtil.SVGEllipse)(m,c,this.item,a),this.item.x-=h/2,this.item.y-=h/2;break;case"polygon":break;case"polystar":break;case"shape":f=(0,_SVGUtil.SVGShape)(m,c,this.item,a),this.item.x-=h/2,this.item.y-=h/2,void 0!==m.timeline&&m.timeline.length>0&&(0,_SVGUtil2.SVGMorph)(f,m.timeline,c,a)}void 0!==f&&(this.item.x-=h/2,this.item.y-=h/2,(0,_SVGUtil.applyMasks)(f,i),c.timeline.length>0&&void 0!==a&&(0,_SVGUtil2.SVGAnimate)(f,c.timeline,a),this.item.appendChild(f))}for(s=o.content.length,l=0;l<s;++l){var p=o.content[l];"trim"===p.type&&applyTrimPath(this.item.children[0],p,a)}}else if("trim"===o.type)for(s=this.item.children.length,l=0;l<s;++l){var v=this.item.children[l];"path"===v.tagName&&applyTrimPath(v,o,a)}}}return _createClass(e,null,[{key:"transform",value:function(e){function t(t,a,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t,a){var i=t.anchor,r=t.position,n=t.rotation,o=t.scale,l=i[0]/e.width*100,s=i[1]/e.height*100;if(e.style.position="absolute",e.x=r[0],e.y=r[1],e.rotateX=n[0],e.rotateY=n[1],e.rotateZ=n[2],e.scaleX=o[0],e.scaleY=o[1],e.originX=l,e.originY=s,e.translateX=-i[0],e.translateY=-i[1],e.translateZ=r.length>2?r[2]:0,e.opacity=t.opacity,void 0!==t.timeline){var c=void 0,h=void 0,m=void 0,f=t.timeline.length;for(c=0;c<f;++c){var p=t.timeline[c];for(m=p.keys.length,h=0;h<m;++h){var v=p.keys[h],u=v.target,y=v.duration,d=v.x0,g=v.y0,S=v.x1,k=v.y1,b=void 0,_={ease:[d,g,S,k],start:v.value,delay:v.start};switch(p.name){case"opacity":b=new Keyframe(e,"opacity",u,y,_);break;case"positionX":b=new Keyframe(e,"x",u,y,_);break;case"positionY":b=new Keyframe(e,"y",u,y,_);break;case"positionZ":b=new Keyframe(e,"translateZ",u,y,_);break;case"rotationX":_.start*=-1,b=new Keyframe(e,"rotateX",(-u),y,_);break;case"rotationY":_.start*=-1,b=new Keyframe(e,"rotateY",(-u),y,_);break;case"rotationZ":b=new Keyframe(e,"rotateZ",u,y,_);break;case"scaleX":b=new Keyframe(e,"scaleX",u,y,_);break;case"scaleY":b=new Keyframe(e,"scaleY",u,y,_);break;case"scaleZ":b=new Keyframe(e,"scaleZ",u,y,_)}void 0!==b&&(b.easeType=v.type,a.addKeyframe(b))}}}})}]),e}();exports["default"]=SVGItem;